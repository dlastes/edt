{% extends "flopeditor/base.html" %}
{% load static %}

{% block link %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'flopeditor/css/bootstrap-select.min.css' %}">
{% endblock %}

{% block body-class %}bg-dark{% endblock %}

{% block main-class %}container h-100{% endblock %}

{% block navbar %}
<div class='pt-2 pl-2'>
  <a href="{% url 'index' %}" class="d-block mx-auto mx-sm-0" style='max-width:300px'>
    <img src="{% static 'base/img/flop2.png' %}" class='btn btn-raised p-0' style='max-width:300px' alt="Retourner vers FlopEDT">
  </a>
</div>
{% endblock %}

{% block content %}
<div class="row h-100 justify-content-center align-items-center text-center text-white">
    <div class="col-12">
        <h1 class="display-1 mb-4"><strong>Flop Editor</strong></h1>
        <p class="lead mb-4">
            Choix du département à éditer :
        </p>
        <div class="department-list row">
          {% for dept in departements %}
            <div class="col-12 mb-3">
              <a href="{% url 'flopeditor:flopeditor-department-default' department_abbrev=dept.abbrev %}" style="min-width: 200px;" type="button" class="btn btn-raised btn-secondary">{{ dept.name }}</a>
            </div>
          {% endfor %}
        </div>

        {% if request.user.is_superuser %}
        <p class="lead">
            Vous pouvez aussi créer un nouveau département <button type="button" class="btn btn-secondary bmd-btn-fab bmd-btn-fab-sm mt-1" data-toggle="modal" data-target="#modal-create-department">ici</button>
        </p>
        {% endif %}

    </div>
</div>
{% endblock %}

{% block modal %}
{% if request.user.is_superuser %}
<div class="modal fade text-black" id="modal-create-department" tabindex="-1" role="dialog" aria-labelledby="modal-create-department" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Créer un département</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body pb-0">
                <form id="form-create-department" action="{% url 'flopeditor:flopeditor-ajax-create-department' %}">
                    {% csrf_token %}
                    <div class="form-inline">
                        <label for="inputNomDep" class="col-form-label col-sm-4">Nom</label>
                        <div class="col-sm-8">
                            <input name="nomDep" maxlength="50" type="text" class="form-control w-100" id="inputNomDep" placeholder="Exemple: Informatique" required>
                        </div>
                    </div>
                    <div class="form-inline mt-4">
                        <label for="inputAbbrev" class="col-form-label col-sm-4">Abréviation</label>
                        <div class="col-sm-8">
                            <input name="abbrevDep" maxlength="7" type="text" class="form-control w-100" id="inputAbbrev" placeholder="Exemple: INFO" required>
                        </div>
                    </div>
                    <div class="form-inline mt-4">
                        <label for="inputResp" class="col-form-label col-sm-4">Responsable</label>
                        <div class="col-sm-8">
                            <select class="selectpicker" data-live-search=true multiple name="respsDep" id="inputResp">
                                {% for admin in admins %}
                                <option value="{{ admin.id }}">{{ admin.last_name }} {{ admin.first_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div id="form-message" class="alert mt-4 mr-2 ml-2 mb-0" role="alert" style="display:none;border-radius:5px;"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary mr-2" data-dismiss="modal">Annuler</button>
                <button id="button-create-department" type="button" class="btn btn-raised btn-info">Créer</button>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block script %}
{{ block.super }}
<script src="{% static 'flopeditor/js/bootstrap-select.min.js' %}" charset="utf-8"></script>
<script type="text/javascript">
  $(function () {
    $('select').selectpicker();
  });
</script>
<script src="{% static 'flopeditor/js/create-department.js' %}" charset="utf-8"></script>
{% endblock %}
